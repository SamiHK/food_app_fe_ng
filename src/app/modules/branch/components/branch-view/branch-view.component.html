<c-row class="" *ngIf="isLoading else elseBlock">
    <c-col class="">
        <c-spinner size="sm"></c-spinner>
        <span class="d-flex-inline my-auto">
            Loading...
        </span>
    </c-col>
</c-row>
<ng-template #elseBlock>
    <c-row class="justify-content-center">
        <c-col md="8">
            <c-card class="mb-4">
                <c-card-body>
                    {{branch.name}} ({{branch.code}})
                </c-card-body>        
            </c-card>
            <h4>Manager</h4>
            <c-card>
                <c-card-body>
                    <c-row *ngIf="!isEditManager else branchForm">
                        <c-col>
                            <span *ngIf="branch.managerId else na">{{branch.manager?.username}}</span>
                            <ng-template #na>N/A</ng-template>
                        </c-col>
                        <c-col xs="2">
                            <span class="float-end">
                                <button cButton (click)="editManager()" color="light" size="sm">Edit</button>
                            </span>
                        </c-col>
                    </c-row>
                    <ng-template #branchForm>
                        <form (ngSubmit)="saveBranch()">
                            <fieldset [disabled]="savingManager">
                                <c-row>
                                    <c-col>
                                        <span *ngIf="!managerLoading else loader">
                                            <select cSelect [(ngModel)]="selectedManagerId" name="branch">
                                                <option value="null">None</option>
                                                <option *ngFor="let i of managerPage.items" [value]="i.id">
                                                    {{i.fullName}} 
                                                </option>
                                            </select>
                                        </span>
                                        <ng-template #loader>
                                            <c-spinner size="sm"></c-spinner>
                                        </ng-template>
                                    </c-col>
                                    <c-col xs="4">
                                        <span class="d-grid gap-2 d-flex float-end">
                                            <button cButton (click)="cancelEditManager()" color="light"
                                                size="sm">Cancel</button>
                                            <button cButton type="submit" size="sm">
                                                <span *ngIf="!savingManager else loader">
                                                    Save
                                                </span>
                                                <ng-template #loader>
                                                    <c-spinner size="sm"></c-spinner>
                                                    Saving...
                                                </ng-template>
                                            </button>
                                        </span>
                                    </c-col>
                                </c-row>
                            </fieldset>
                        </form>
                    </ng-template>
                </c-card-body>
            </c-card>
        </c-col>
    </c-row>
</ng-template>